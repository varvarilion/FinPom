import telebot
from telebot import types
from openpyxl import *

wb = load_workbook('FinPom2.xlsx')
sheet1 = wb.worksheets[0]
sheet1['A1'] = 1

current_row = sheet1.max_row

token = "5946905739:AAFOF4jmWwy39nCzCxjnvSAx8sy0HnBBc_8"
bot = telebot.TeleBot(token)

@bot.message_handler(commands=["start"])
def menu(message):
    us_id = message.from_user.id
    flag = True
    for i in range(1, sheet1.max_row + 1):
        for j in range(1, sheet1.max_column + 1):
            if us_id == sheet1.cell(i, j).value:
                flag = False
                break

    if flag:
        sheet1['C4'].value = 100500
        print(22)
    markup2 = types.ReplyKeyboardMarkup(resize_keyboard=True)
    btn11 = types.KeyboardButton("Внести изменение в бюджет")
    btn12 = types.KeyboardButton("Мои доходы")
    btn13 = types.KeyboardButton("Мои расходы")
    markup2.add(btn11, btn12, btn13)
    bot.send_message(message.chat.id, text="Чем я могу вам помочь?", reply_markup=markup2)


@bot.message_handler(content_types=['text'])
def _command_(message):
    flag1 = False
    money_type = ''

    if (message.text == "В меню"):
        markup2 = types.ReplyKeyboardMarkup(resize_keyboard=True)
        btn11 = types.KeyboardButton("Внести изменение в бюджет")
        btn12 = types.KeyboardButton("Мои доходы")
        btn13 = types.KeyboardButton("Мои расходы")
        markup2.add(btn11, btn12, btn13)
        bot.send_message(message.chat.id, text="Чем я могу вам помочь?", reply_markup=markup2)

    elif message.text == "Внести изменение в бюджет":
        markup3 = types.ReplyKeyboardMarkup(resize_keyboard=True)
        btn21 = types.KeyboardButton("Добавить доход")
        btn22 = types.KeyboardButton("Добавить расход")
        btn23 = types.KeyboardButton("В меню")
        markup3.add(btn21, btn22, btn23)
        bot.send_message(message.chat.id, text="Выберите тип изменения", reply_markup=markup3)

    elif (message.text == "Добавить доход"):
        markup6 = types.ReplyKeyboardMarkup(resize_keyboard=True)
        btn61 = types.KeyboardButton("Наличные⬆️")
        btn62 = types.KeyboardButton("Безналичные⬆️")
        btn63 = types.KeyboardButton("В меню")
        markup6.add(btn61, btn62, btn63)
        bot.send_message(message.chat.id, text="Выберите счёт", reply_markup=markup6)

    elif (message.text == "Добавить расход"):
        markup6 = types.ReplyKeyboardMarkup(resize_keyboard=True)
        btn61 = types.KeyboardButton("Наличные⬇️")
        btn62 = types.KeyboardButton("Безналичные⬇️")
        btn63 = types.KeyboardButton("В меню")
        markup6.add(btn61, btn62, btn63)
        bot.send_message(message.chat.id, text="Выберите счёт", reply_markup=markup6)

    elif message.text == "Мои доходы":
        op_type = "doh_check"
        markup6 = types.ReplyKeyboardMarkup(resize_keyboard=True)
        btn61 = types.KeyboardButton("Всего")
        btn62 = types.KeyboardButton("Наличные")
        btn63 = types.KeyboardButton("Безналичные")
        btn64 = types.KeyboardButton("В меню")
        markup6.add(btn61, btn62, btn63, btn64)
        bot.send_message(message.chat.id, text="Выберите счёт", reply_markup=markup6)
    elif message.text == "Мои расходы":
        op_type = "ras_check"
        markup6 = types.ReplyKeyboardMarkup(resize_keyboard=True)
        btn61 = types.KeyboardButton("Всего")
        btn62 = types.KeyboardButton("Наличные")
        btn63 = types.KeyboardButton("Безналичные")
        btn64 = types.KeyboardButton("В меню")
        markup6.add(btn61, btn62, btn63, btn64)
        bot.send_message(message.chat.id, text="Выберите счёт", reply_markup=markup6)

    elif (message.text == "Наличные⬆️") or (message.text == "Безналичные⬆️"):
        if (message.text == "Наличные⬆️"):
            op_type = "up_nal"
        else:
            op_type = "up_beznal"
        bot.send_message(message.chat.id, text="Введите сумму")
    elif (message.text == "Наличные⬇️") or (message.text == "Безналичные⬇️"):
        if (message.text == "Наличные⬇️"):
            op_type = "down_nal"
        else:
            op_type = "down_beznal"
        bot.send_message(message.chat.id, text="Введите сумму")


    flag = False
    for i in range(len(message.text)):
        if message.text[i] in "123456789":
            flag = True
    if flag:
        money = int(message.text)
        print(money)



bot.infinity_polling()
